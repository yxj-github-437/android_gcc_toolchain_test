name: android gcc builds

on: [push]

jobs:
  prepare_ndk:
    runs-on: ubuntu-latest
    env:
      NDK_VERSION: android-ndk-r28c
    steps:
      - name: download ndk
        run: |
            if [ ! -d "/opt/ndk/" ]; then
              # 下载NDK
              wget https://dl.google.com/android/repository/android-ndk-r$NDK_VERSION-linux.zip
              unzip android-ndk-r$NDK_VERSION-linux.zip -d /opt/
              mv /opt/android-ndk-r$NDK_VERSION /opt/ndk
              echo "ANDROID_NDK_HOME=/opt/ndk" >> $GITHUB_ENV
            fi

      - name: cache NDK
        uses: actions/cache@v4
        with:
          path: /opt/ndk/
          key: ${{ runner.os }}-ndk-${{ hashFiles('**/source.properties') }}
          restore-keys: |
            ${{ runner.os }}-ndk-

  test_ndk:
    runs-on: ubuntu-latest
    needs: prepare_ndk
    steps:
      - name: check clang
        run: |
          /opt/ndk/toolchains/llvm/prebuilt/linux-x86_64/bin/clang++ -v





